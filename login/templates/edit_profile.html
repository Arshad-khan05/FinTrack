{% extends 'base.html' %}
{% load static %}

{% block title %}Edit Profile - FinTrack{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="card auth-card scale-in">
        <div class="auth-header">
            <div class="auth-icon">ðŸ‘¤</div>
            <h2 class="auth-title">Edit Profile</h2>
            <p class="auth-subtitle">Update your name or password</p>
        </div>

        <form method="post" autocomplete="off" class="auth-form">
            {% csrf_token %}

            <div class="form-group">
                <label class="form-label">Username</label>
                <input type="text" class="form-input" value="{{ username }}" readonly>
            </div>

            <div class="form-group">
                <label for="email" class="form-label">Email</label>
                <input type="email" id="email" name="email" class="form-input" value="{{ email }}" readonly>
            </div>

            <div class="form-group">
                <label for="firstname" class="form-label">First Name</label>
                <input type="text" id="firstname" name="firstname" class="form-input" value="{{ first_name }}" required>
            </div>

            <div class="form-group">
                <label for="lastname" class="form-label">Last Name</label>
                <input type="text" id="lastname" name="lastname" class="form-input" value="{{ last_name }}" required>
            </div>

            <hr style="margin: var(--spacing-md) 0;">
            <p style="color: var(--text-secondary); font-size: 0.95rem;">To change your password, provide your current password and the new password below.</p>

            <div class="form-group">
                <label for="current_password" class="form-label">Current Password</label>
                <input type="password" id="current_password" name="current_password" class="form-input" placeholder="Enter current password">
            </div>

            <div class="form-group">
                <label for="new_password" class="form-label">New Password</label>
                <input type="password" id="new_password" name="new_password" class="form-input" placeholder="New password (min 6 chars)">
            </div>

            <div class="form-group">
                <label for="confirm_password" class="form-label">Confirm New Password</label>
                <input type="password" id="confirm_password" name="confirm_password" class="form-input" placeholder="Confirm new password">
            </div>

            <button type="submit" class="btn btn-primary" style="width: 100%;">Save Changes</button>
        </form>

    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', () => {
    const newPass = document.getElementById('new_password');
    const confirmPass = document.getElementById('confirm_password');

    function validatePasswords() {
        if (newPass.value && confirmPass.value && newPass.value !== confirmPass.value) {
            confirmPass.setCustomValidity('Passwords do not match');
        } else {
            confirmPass.setCustomValidity('');
        }
    }

    newPass.addEventListener('input', validatePasswords);
    confirmPass.addEventListener('input', validatePasswords);
});
</script>
{% endblock %}
