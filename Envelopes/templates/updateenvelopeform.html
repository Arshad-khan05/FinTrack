{% extends 'base.html' %}
{% load static %}

{% block title %}Update {{ envelope.Envelope_Name }} - FinTrack{% endblock %}

{% block content %}
<div class="form-container fade-in">
    <!-- Form Header -->
    <div class="form-header">
        <h1>‚úèÔ∏è Update Envelope</h1>
        <p style="color: var(--text-secondary);">Modify details for <strong>{{ envelope.Envelope_Name }}</strong></p>
    </div>
    
    <!-- Current Status Card -->
    <div class="card slide-up" style="margin-bottom: 2rem; background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);">
        <h3 style="margin-bottom: 1rem;">üìä Current Status</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
            <div>
                <div style="font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase; margin-bottom: 0.5rem;">Allocated</div>
                <div style="font-size: 1.25rem; font-weight: 700; color: var(--primary-light);">‚Çπ{{ envelope.Money_Allocated|floatformat:2 }}</div>
            </div>
            <div>
                <div style="font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase; margin-bottom: 0.5rem;">Spent</div>
                <div style="font-size: 1.25rem; font-weight: 700; color: var(--error);">‚Çπ{{ envelope.Money_Spent|floatformat:2 }}</div>
            </div>
            <div>
                <div style="font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase; margin-bottom: 0.5rem;">Remaining</div>
                <div style="font-size: 1.25rem; font-weight: 700; color: var(--success);">‚Çπ{{ envelope.Money_Remaining|floatformat:2 }}</div>
            </div>
        </div>
    </div>
    
    <!-- Update Form -->
    <div class="card form-card slide-up stagger-1">
        <form action="" method="post">
            {% csrf_token %}
            
            <div class="form-group">
                <label for="name" class="form-label">Envelope Name</label>
                <input 
                    type="text" 
                    id="name" 
                    name="name" 
                    class="form-input" 
                    value="{{ envelope.Envelope_Name }}"
                    required
                    autofocus
                >
            </div>
            
            <div class="form-group">
                <label for="budget" class="form-label">Budget Amount (‚Çπ)</label>
                <input 
                    type="number" 
                    id="budget" 
                    name="budget" 
                    class="form-input" 
                    value="{{ envelope.Money_Allocated }}"
                    min="0"
                    step="0.01"
                    required
                >
                <span class="form-help">Total amount allocated for this envelope</span>
            </div>
            
            <div class="form-group">
                <label for="spend" class="form-label">Money Spent (‚Çπ)</label>
                <input 
                    type="number" 
                    id="spend" 
                    name="spend" 
                    class="form-input" 
                    value="{{ envelope.Money_Spent }}"
                    min="0"
                    step="0.01"
                    required
                >
                <span class="form-help">Update the total spent amount</span>
            </div>
            
            <div class="form-actions">
                <a href="{% url 'updateenvelope' %}" class="btn btn-ghost">Cancel</a>
                <button type="submit" class="btn btn-success">
                    ‚úì Update Envelope
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Calculate and display remaining amount in real-time
    document.addEventListener('DOMContentLoaded', () => {
        const budgetInput = document.getElementById('budget');
        const spentInput = document.getElementById('spend');
        
        function calculateRemaining() {
            const budget = parseFloat(budgetInput.value) || 0;
            const spent = parseFloat(spentInput.value) || 0;
            const remaining = budget - spent;
            
            // You could add a live preview here if needed
        }
        
        budgetInput.addEventListener('input', calculateRemaining);
        spentInput.addEventListener('input', calculateRemaining);
    });
</script>
{% endblock %}